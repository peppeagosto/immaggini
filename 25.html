<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Il Cartaio - Cometa</title>
<style>
  *{margin:0;padding:0}
  body,html{
    height:100vh;
    overflow:hidden;
    background:#000;
    display:flex;
    justify-content:center;
    align-items:center;
    font-family:Arial,sans-serif;
    position:relative;
  }
  .container{
    position:relative;
    width:1330px;
    height:486px;
    text-align:center;
  }
  .vid{
    position:absolute;
    width:330px;
    height:486px;
    object-fit:cover;
    border-radius:10px;
    box-shadow:0 0 20px rgba(255,0,0,.7);
    z-index:2;
  }
  .left{left:-40px;top:0;}
  .right{right:-40px;top:0;}
  .center{
    position:absolute;
    left:50%;
    top:0;
    transform:translateX(-50%);
    width:728px;
    height:486px;
    z-index:3;
    border:3px solid #ff0000;
    border-radius:12px;
    box-shadow:0 0 30px rgba(255,0,0,0.8);
    animation:fade 20s infinite;
  }
  @keyframes fade {
    0%,40%{opacity:1} 50%,90%{opacity:0} 100%{opacity:1}
  }
  canvas{
    position:fixed;
    top:0;left:0;
    pointer-events:none;
  }
  #stars-canvas{z-index:1}
  #snow-canvas{z-index:4}
  #comet-canvas{z-index:5}

  /* PULSANTE FISSO E CLICCABILE */
  #playAudio{
    position: absolute;
    bottom: -60px;
    left: 50%;
    transform: translateX(-50%);
    padding: 14px 32px;
    font-size: 18px;
    font-weight: bold;
    color: #fff;
    background: #c00;
    border: 3px solid #f00;
    border-radius: 15px;
    cursor: pointer;
    box-shadow: 0 0 25px #f00, inset 0 0 15px rgba(255,0,0,0.5);
    z-index: 9999;
    pointer-events: auto !important;
    transition: all 0.3s;
    user-select: none;
  }
  #playAudio:hover {
    background: #a00;
    transform: translateX(-50%) scale(1.05);
    box-shadow: 0 0 35px #ff0, inset 0 0 20px rgba(255,255,0,0.5);
  }
  #playAudio:active {
    transform: translateX(-50%) scale(0.98);
  }
</style>
</head>
<body>

<div class="container">
  <video class="vid left" autoplay loop muted playsinline preload="auto">
    <source src="https://peppeagosto.github.io/immaggini/25.mp4" type="video/mp4">
  </video>
  <video class="vid center" autoplay loop muted playsinline preload="auto">
    <source src="https://peppeagosto.github.io/immaggini/babbo.mp4" type="video/mp4">
  </video>
  <video class="vid right" autoplay loop muted playsinline preload="auto">
    <source src="https://peppeagosto.github.io/immaggini/25.mp4" type="video/mp4">
  </video>

  <!-- PULSANTE CON FUNZIONE JS SICURA -->
  <button id="playAudio" onclick="playChristmasAudio()">Ascolta Il buon Natale Da Gerry</button>
</div>

<!-- AUDIO CON ID -->
<audio id="voce" preload="auto" oncanplaythrough="audioReady=true">
  <source src="https://peppeagosto.github.io/immaggini/25.m4a" type="audio/mp4">
  Your browser does not support the audio element.
</audio>

<canvas id="stars-canvas"></canvas>
<canvas id="snow-canvas"></canvas>
<canvas id="comet-canvas"></canvas>

<script>
// Variabile per sapere se l'audio Ã¨ pronto
let audioReady = false;
const audio = document.getElementById('voce');

// Funzione sicura per riprodurre l'audio
function playChristmasAudio() {
  // Sblocca il contesto audio (obbligatorio su mobile)
  if (audio.paused) {
    const playPromise = audio.play();
    if (playPromise !== undefined) {
      playPromise
        .then(() => {
          console.log("Audio riprodotto con successo!");
          document.getElementById('playAudio').textContent = "Riproducendo...";
          setTimeout(() => {
            document.getElementById('playAudio').textContent = "Ascolta Il buon Natale Da Gerry";
          }, 3000);
        })
        .catch(err => {
          console.log("Errore riproduzione:", err);
          alert("Premi di nuovo per ascoltare! (Prima interazione richiesta)");
        });
    }
  }
}

// CANVAS (invariati)
const canvases = ['stars-canvas','snow-canvas','comet-canvas'].map(id=>document.getElementById(id));
const ctxs = canvases.map(c=>c.getContext('2d'));
const [sctx,nctx,cctx]=ctxs;
const resize=()=>canvases.forEach(c=>{c.width=innerWidth;c.height=innerHeight});
resize(); window.onresize=resize;

// STELLE
const stars=[],numStars=160;
class Star{constructor(){this.reset();} reset(){this.size=Math.random()*3.2+1; this.x=Math.random()*innerWidth; this.y=-60; this.speed=Math.random()*1.8+0.6; this.time=0; this.duration=Math.random()*18+12; this.phase=Math.random()*Math.PI*2;} update(){this.time+=0.016; this.y+=this.speed; if(this.time>this.duration||this.y>innerHeight+60)this.reset();} draw(){const pulse=0.75+0.25*Math.sin(this.time*6+this.phase); sctx.globalAlpha=pulse; sctx.shadowBlur=22;sctx.shadowColor='#fff'; sctx.beginPath();sctx.arc(this.x,this.y,this.size,0,Math.PI*2); sctx.fillStyle='#fff'; sctx.fill(); if(this.size>2.3){ sctx.shadowBlur=35;sctx.shadowColor='#ffd700'; drawStar(sctx,this.x,this.y,this.size*2.2,this.size*0.9); }}}
for(let i=0;i<numStars;i++)stars.push(new Star());
function animateStars(){sctx.clearRect(0,0,innerWidth,innerHeight);stars.forEach(s=>{s.update();s.draw();});requestAnimationFrame(animateStars);}
animateStars();

// NEVE
const flakes=[],numFlakes=80;
class Flake{constructor(){this.reset();} reset(){this.x=Math.random()*innerWidth; this.y=-10; this.size=Math.random()*2+1; this.speed=Math.random()*1+0.5; this.opacity=Math.random()*0.5+0.5; this.wind=Math.random()*2-1;} update(){this.y+=this.speed;this.x+=this.wind*0.3;if(this.y>innerHeight||this.x<-20||this.x>innerWidth+20)this.reset();} draw(){nctx.globalAlpha=this.opacity;nctx.fillStyle='#fff';nctx.beginPath();nctx.arc(this.x,this.y,this.size,0,Math.PI*2);nctx.fill();}}
for(let i=0;i<numFlakes;i++)flakes.push(new Flake());
function animateSnow(){nctx.clearRect(0,0,innerWidth,innerHeight);flakes.forEach(f=>{f.update();f.draw();});requestAnimationFrame(animateSnow);}
animateSnow();

// COMETA
const comet={x:innerWidth+50,y:50,speedX:-5,speedY:3,size:28,trail:[],maxTrail:50};
function drawStar(ctx,cx,cy,R,r){let rot=Math.PI/2*3; ctx.beginPath(); ctx.moveTo(cx,cy-R); for(let i=0;i<5;i++){ ctx.lineTo(cx+Math.cos(rot)*R,cy+Math.sin(rot)*R); rot+=Math.PI/5; ctx.lineTo(cx+Math.cos(rot)*r,cy+Math.sin(rot)*r); rot+=Math.PI/5;} ctx.closePath(); const grad=ctx.createRadialGradient(cx,cy,0,cx,cy,R); grad.addColorStop(0,'#ffffff'); grad.addColorStop(0.4,'#fff8a8'); grad.addColorStop(1,'#ffdc64'); ctx.fillStyle=grad; ctx.fill();}
function animateComet(){cctx.clearRect(0,0,innerWidth,innerHeight); comet.x += comet.speedX; comet.y += comet.speedY; if(comet.x < -50 || comet.x > innerWidth+50) comet.speedX*=-1; if(comet.y < 0 || comet.y > innerHeight-50) comet.speedY*=-1; comet.trail.push({x:comet.x,y:comet.y}); if(comet.trail.length>comet.maxTrail) comet.trail.shift(); comet.trail.forEach((p,i)=>{const alpha=(i+1)/comet.trail.length; cctx.globalAlpha=alpha*0.7; cctx.shadowBlur=30; cctx.shadowColor=`rgba(255,220,100,${alpha})`; cctx.beginPath(); cctx.arc(p.x,p.y,comet.size*0.5*alpha,0,Math.PI*2); cctx.fillStyle='#ffdc64'; cctx.fill();}); cctx.globalAlpha=1; cctx.shadowBlur=60; cctx.shadowColor='#ffd700'; drawStar(cctx,comet.x,comet.y,comet.size,comet.size*0.45); requestAnimationFrame(animateComet);}
animateComet();

</script>
</body>
</html>





















